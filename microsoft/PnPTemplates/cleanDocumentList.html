<!--
	INFO: I want the root slots:
		* Title - the document name/title
		* FileType - the document's file type for the icon
		* PreviewUrl - the URL to open the document with
-->
<content id="data-content">
	<style>
	.template_root {
		--theme-primary: {{@root.theme.palette.themePrimary}};
	}
	.template_resultList {
		padding-left: 0px;
		list-style: none;
	}
	.template_result {
		a {
			color: inherit;
			height: 3em;
			display: flex;
			align-items: center;
			gap: 0.5em;
			text-decoration: none;
		}
		.template_fileIcon {
			display: flex;
			align-items: center;
			justify-content: center;
			width: 3em;
			i { margin: 0px }
			i img { vertical-align: top }
			flex-shrink: 0;
		}
	}
	.pagination a {
		color: inherit;
		font-weight: lighter;
	}
	.pagination li:hover a {
		color: var(--theme-primary);
		text-decoration: underline;
	}
	</style>
	
	<div class="template_root">
		<ul class="template_resultList">
			<!-- Iterate over our results -->
			{{#each data.items as |item|}}
				<!-- If there is a result type specific template, use that -->
				{{#> resultTypes item=item}}
					<!-- Fallback -->
					<li class="template_result ms-bgColor-gray10--hover ms-fontColor-themeDarkAlt--hover">
						{{! If we're a .url or OneDrive shortcut...}}
						<a href="{{#if (or (eq (slot item @root.slots.FileType) 'url') (eq (slot item @root.slots.FileType) 'AddToOneDrive.Shortcut') ) ~}}
							{{#if ( get item ShortcutUrl ) }}
								{{~ join ( unique ( split ( get item ShortcutUrl ) ', ' ) ) ~}}
							{{else}}
								{{#with (get item HitHighlightUrl) }}
									{{#contains . '<ddd/>'}}
										{{#with (replace . '<ddd/>' '')}}{{last (split . '=')}}{{/with}}
									{{else}}
										{{slot item @root.slots.PreviewUrl}}
									{{/contains}}
								{{/with}}
							{{/if}}
						{{~else~}}
							{{slot item @root.slots.PreviewUrl}}
						{{~/if}}" target="_blank" data-interception="off" rel="noopener noreferrer">
	                        <pnp-iconfile class="template_fileIcon" data-size="32" data-extension="{{#if (eq (slot item @root.slots.FileType) 'AddToOneDrive.Shortcut') }}
									{{~first ( last (split ( get item Filename ) '.') 2) ~}}
								{{else}}
									{{~slot item @root.slots.FileType~}}
								{{/if}}"></pnp-iconfile>
							<span class="template_itemName"> {{slot item @root.slots.Title}}</span>
						</a>
					</li>
				{{/resultTypes}}
			{{/each}}
		</ul>
		{{#if @root.properties.paging.showPaging}}
			{{#if (lt @root.properties.paging.itemsCountPerPage @root.data.totalItemsCount) }}
			    <pnp-pagination
			        data-total-items="{{@root.data.totalItemsCount}}"
			        data-hide-first-last-pages="{{@root.properties.paging.hideFirstLastPages}}"
			        data-hide-disabled="{{@root.properties.paging.hideDisabled}}"
			        data-hide-navigation="{{@root.properties.paging.hideNavigation}}"
			        data-range="{{@root.properties.paging.pagingRange}}"
			        data-items-count-per-page="{{@root.properties.paging.itemsCountPerPage}}"
			        data-current-page-number="{{@root.paging.currentPageNumber}}"
			    >
			    </pnp-pagination>
			{{/if}}
		{{/if}}
	</div>
</content>

<!-- The placeholder until the data has loaded & template has rendered -->
<content id="placeholder-content">
	<style>
	.template_resultList {
		padding-left: 0px;
		list-style: none;
	}
	.template_result {
		a {
			height: 3em;
			display: flex;
			gap: 0.5em;
			text-decoration: none;
		}
		.template_fileIcon {
			display: flex;
			align-items: center;
			justify-content: center;
			width: 3em;
			i { margin: 0px }
			i img { vertical-align: top }
		}
	}
	</style>

	<div class="template_root">
		<ul class="template_resultList">
			<!-- Loop for the number of per-page items -->
			{{#times @root.properties.paging.itemsCountPerPage}}
				<li class="template_result"><a>
					<div class="template_fileIcon">
						<div class="placeholder--shimmer" style="width: 32px; height: 32px;"></div>
					</div>
					<span class="placeholder--shimmer placeholder--line template_itemName" style="width: 100%"></span>
				</a></li>
			{{/times}}
		</ul>
	</div>
</content>

